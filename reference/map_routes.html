<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="map_routes plots routes, with many options"><title>Map a set of routes — map_routes • himach</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Map a set of routes — map_routes"><meta property="og:description" content="map_routes plots routes, with many options"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">himach</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Supersonic_Routes.html">Introduction to Supersonic Routing</a>
    <a class="dropdown-item" href="../articles/Supersonic_Routes_in_depth.html">Advanced Supersonic Routing</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/david6marsh/himach/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Map a set of routes</h1>
      <small class="dont-index">Source: <a href="https://github.com/david6marsh/himach/blob/HEAD/R/maps.R" class="external-link"><code>R/maps.R</code></a></small>
      <div class="d-none name"><code>map_routes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>map_routes</code> plots routes, with many options</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">map_routes</span><span class="op">(</span></span>
<span>  <span class="va">thin_map</span>,</span>
<span>  routes <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  crs <span class="op">=</span> <span class="fu">himach</span><span class="fu">::</span><span class="va"><a href="crs_Atlantic.html">crs_Atlantic</a></span>,</span>
<span>  show_route <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"speed"</span>, <span class="st">"aircraft"</span>, <span class="st">"time"</span>, <span class="st">"circuity"</span>, <span class="st">"acceleration"</span>, <span class="st">"traffic"</span><span class="op">)</span>,</span>
<span>  fat_map <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  avoid_map <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ap_loc <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ap_col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>  ap_size <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  forecast <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  fc_var <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  fc_text <span class="op">=</span> <span class="cn">NA_character_</span>,</span>
<span>  crow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  crow_col <span class="op">=</span> <span class="st">"grey70"</span>,</span>
<span>  crow_size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  route_envelope <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  bound <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bound_margin_km <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  simplify_km <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  land_f <span class="op">=</span> <span class="st">"grey90"</span>,</span>
<span>  buffer_f <span class="op">=</span> <span class="st">"grey60"</span>,</span>
<span>  land_c <span class="op">=</span> <span class="st">"grey85"</span>,</span>
<span>  land_s <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  avoid_f <span class="op">=</span> <span class="st">"grey80"</span>,</span>
<span>  avoid_c <span class="op">=</span> <span class="st">"grey95"</span>,</span>
<span>  avoid_s <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  l_alpha <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  l_size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  e_alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  e_size <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  e_col <span class="op">=</span> <span class="st">"grey70"</span>,</span>
<span>  refuel_airports <span class="op">=</span> <span class="va">ap_loc</span>,</span>
<span>  rap_col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  rap_size <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  scale_direction <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="st">""</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>thin_map</dt>
<dd><p>The minimum is a <code>MULTIPOLYGON</code> map, 'thin' in that it
is without buffer, so a normal coastline map.</p></dd>


<dt>routes</dt>
<dd><p>as generated by <code><a href="find_route.html">find_route</a></code></p></dd>


<dt>crs</dt>
<dd><p>Coordinate reference system, default <code>crs_Atlantic</code>.</p></dd>


<dt>show_route</dt>
<dd><p>one of "speed", "aircraft", "time", "circuity", "accel",
"traffic" to indicate what goes in the legend.</p></dd>


<dt>fat_map</dt>
<dd><p>optional coast + buffer map, default NA.</p></dd>


<dt>avoid_map</dt>
<dd><p>optional map of no-fly zones, default NA.</p></dd>


<dt>ap_loc</dt>
<dd><p>Show used origin and destination airports if this is a set of
airports from <code><a href="make_airports.html">make_airports</a></code>, or not if NA (default). This
dataset can be all airports, and is filtered to those used by
<code>routes</code>.</p></dd>


<dt>ap_col, ap_size</dt>
<dd><p>Colour and size of used airport markers (dark blue,
0.4)</p></dd>


<dt>forecast, fc_var, fc_text</dt>
<dd><p>Forecast set and two strings. See details,
default NA.</p></dd>


<dt>crow, crow_col, crow_size</dt>
<dd><p>If TRUE, show the 'crow-flies' direct great
circle, in colour <code>crow_col</code> and thickness <code>crow_size</code>. Default
FALSE, "grey70", 0.2</p></dd>


<dt>route_envelope</dt>
<dd><p>show the route envelope (default FALSE).</p></dd>


<dt>bound, bound_margin_km</dt>
<dd><p>If bound=TRUE (default) crop to bounding box of
the <code>routes</code>, with additional <code>bound_margin_km</code> in km (default
200)</p></dd>


<dt>simplify_km</dt>
<dd><p>Simplify the two maps to this scale before plotting
(default 10).</p></dd>


<dt>land_f, buffer_f, avoid_f</dt>
<dd><p>fill colours for thin, fat and no-fly maps,
default grey 90, 70 and 80, respectively</p></dd>


<dt>land_c, land_s</dt>
<dd><p>boundary colour and size for land areas (countries),
default grey 85 and 0.2, respectively (use NA to turn off)</p></dd>


<dt>avoid_c, avoid_s</dt>
<dd><p>boundary colour and size for avoid areas, default grey
95 and 0.3, respectively</p></dd>


<dt>l_alpha, l_size</dt>
<dd><p>line (route) settings for alpha (transparency) and
width, defaults 0.6 and 0.4.</p></dd>


<dt>e_col, e_alpha, e_size</dt>
<dd><p>colour, alpha and width for the range envelope.
Default "grey70", 0.4, 0.6</p></dd>


<dt>refuel_airports</dt>
<dd><p>Show the used refuel airports using these locations,
or nothing if NA. (Defaults to same as <code>ap_loc</code>.)</p></dd>


<dt>rap_col, rap_size</dt>
<dd><p>Colour and size of refuel airport markers (red, 0.4)</p></dd>


<dt>scale_direction</dt>
<dd><p>Passed to scale_colour_viridis, either -1 (default) or
or 1.</p></dd>


<dt>title, subtitle</dt>
<dd><p>Passed to ggplot.</p></dd>


<dt>warn</dt>
<dd><p>if TRUE show some warnings (when defaults loaded) (default FALSE)</p></dd>


<dt>...</dt>
<dd><p>further parameters passed to <code>scale_colour_viridis_b</code> (or _c,
_d), such as <code>breaks = </code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>ggplot</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function plots the routes, with options for additional layers. Multiple
routes are expected, and they can be coloured by time advantage, by speed
along each segment, or by aircraft type.</p>
<p>The option <code>show_route</code> "time" requires 'advantage_h' to have been added
to the routes set, from the route summary. If it hasn't then this is done in
a local version, then discarded. Running <code>summarise_routes</code> to do this
requires an airport dataset; if <code>is.na(ap_loc)</code> then this is not
available, so a default set is used. You can turn on <code>warn</code> to see if
this is happening, but by default it is silent.</p>


<p>For <code>show_route = </code> "speed", "aircraft", "time", "circuity" or "accel",
the information is already available in the <code>routes</code> dataset. For
<code>show_route = "traffic"</code> you need to provide a forecast dataset that
contains at least the <code>fullRouteID and acID</code> fields which are normal in
the <code>routes</code> dataset, and a field giving the volume of the forecast
<code>fc_var</code>. This could be flights, seats, or something else: use
<code>fc_text</code> for the legend title to show the units of <code>fc_var</code>.
Combinations of <code>fullRouteID and acID</code> must be unique, which probably
means you must filter by forecast year and forecast scenario before passing
to <code>map_routes</code>.</p>
<p>The time to compute the map may not be very different with <code>simplify_km</code>
varying between 2km and 20km, but the time to plot on the screen, or
<code>ggsave</code> to a file, is longer than the compute time. It is this latter
time that's reduced by simplifying the maps. For single, or short routes, you
can probably see the difference between 2km and 10km, so it's your choice to
prefer speed or beauty.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#see introductory vignette</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by David Marsh, EUROCONTROL.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

